<script setup lang="ts">
import { useResearchStore } from '../stores/research';
import { computed } from 'vue';
import { mapStyle } from '../assets/map/mapStyle';
import { Tenant } from "@/enums/tenant.enum";

// const { centerLocation, treatment, currentStep } = storeToRefs(useResearchStore());
const researchStore = useResearchStore();

const GMAP_API_KEY = import.meta.env.VITE_GMAP_API_KEY;
const styleCircle = {
    radius: 2000,
    strokeColor: 'rgba(255, 255, 255, 0.9)',
    strokeOpacity: 0.7,
    strokeWeight: 2,
    fillColor: 'rgba(255, 255, 255, 0.3)',
    fillOpacity: 0.9,
}
const { researchConfiguration } = useResearchStore();

const showFilters = computed(() => {
    return treatment.value !== 1 ;
})

const treatment = computed(() => {
    return researchStore.researchConfiguration.treatment;
})
const getSrcIframeExplorer = () => {
    const { location, grades, hasPriority: applyScholarships } = researchConfiguration;

    // FIXME: Hardcoded for now

    const urlTenantStringsMapping = {
        [Tenant.CL]: {
            primary: 'chile',
            secondary: 'chile',
        },
        [Tenant.DO]: {
            primary: 'rd',
            secondary: 'dominicana',
        },
    }

    const urlTenant = urlTenantStringsMapping[researchConfiguration.tenant.toUpperCase() as Tenant];

    const urlRoot: string = import.meta.env.VITE_IFRAME_EXPLORER_TEMPLATE_URL
        .replaceAll(
            '{primaryTenant}',
            urlTenant.primary,
        ).replaceAll(
            '{secondaryTenant}',
            urlTenant.secondary,
        );
    const url = new URL('/research_iframe', urlRoot);
    url.searchParams.append('lat', location.lat.toString());
    url.searchParams.append('lng', location.lng.toString());
    url.searchParams.append('radius', '3');
    url.searchParams.append('z', '14.5');
    url.searchParams.append('filters', `${showFilters.value}`);
    // url.searchParams.append('vacanciesOff', 'false');
    for (const grade of (grades || [])) {
        url.searchParams.append('grade', grade.toString());
    }
    url.searchParams.append('force_scholarships', `${applyScholarships}`);

    console.log('url', url)
    return url.toString();
};

const nextStep = () => {
    researchStore.sendTopPostMessage('setAnswer', '', true);
    researchStore.sendTopPostMessage('setTrackMixPanel', {
        track: 'click_go_to_explorer',
        data: {}
    })
    researchStore.sendTopPostMessage('close', true);
}

</script>
<template>
    <div class="w-full d-flex flex-column">
        <div class="go-to-explorer">
            <!-- label -->
            <span class="ml-2 mb-2">En el explorador puedes encontrar todos los establecimientos cercanos a tu
                ubicación de preferencia.</span>
            <!-- results -->
            <section v-if="treatment !== 1" class="go-to-explorer__information mt-3">
                <div style="position: relative;">
                    <p class="mt-4 ml-3 d-flex">{{ researchStore.researchConfiguration.totalCampusesAround }}
                        <img v-if="treatment === 3" src="../assets/schoolfilter.svg" alt="">
                    </p>
                    <span class="information ml-3" :class="treatment === 3 ? '' : 'mt-2'">establecimientos</span>
                    <span class="information ml-3">educacionales</span>
                    <img src="../assets/rectangule-purple.svg" alt="">
                </div>
                <div class="second-information">
                    <p class="mt-5 ml-3">{{ researchStore.researchConfiguration.totalCampusesAroundPaymentAndPerformance }}
                        <img v-if="treatment === 3" src="../assets/filters.svg" alt="">
                    </p>
                    <span class="information mt-2 ml-3">de bajo costo y</span>
                    <span class="information ml-3">alto desempeño</span>
                    <img class="mt-2 mr-3" src="../assets/rectangule-blue.svg" alt="" height="95">
                </div>
                <div style="position: absolute; box-sizing: border-box;">
                    <div class="total-vacancies"
                        style="background: #B2C2FE; position: absolute; top: 90%; left: 26%; z-index: 2; height: 40px; width: 20px; display: flex; justify-content: center; align-items: center;">
                        {{ researchStore.researchConfiguration.interface.totalCampusesWhitVacanciesAround }}
                    </div>
                    <svg style="position: absolute; top: 75%; left: 20%;" width="200" height="80" viewBox="0 0 200 60"
                        fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd" clip-rule="evenodd"
                            d="M8 0C3.58172 0 0 3.58172 0 8V42C0 46.4183 3.58172 50 8 50H138.429L146.241 59.1142C146.64 59.5798 147.36 59.5798 147.759 59.1142L155.571 50H169C173.418 50 177 46.4183 177 42V8C177 3.58172 173.418 0 169 0H8Z"
                            fill="#B2C2FE" />
                        <path
                            d="M24.656 19.32C24.4507 18.4613 24.0773 17.8173 23.536 17.388C22.9947 16.9587 22.2387 16.744 21.268 16.744C19.7933 16.744 18.692 17.3133 17.964 18.452C17.236 19.572 16.8533 21.4387 16.816 24.052C17.3013 23.2307 18.0107 22.596 18.944 22.148C19.8773 21.7 20.8853 21.476 21.968 21.476C23.2 21.476 24.2827 21.7467 25.216 22.288C26.168 22.8107 26.9053 23.576 27.428 24.584C27.9693 25.592 28.24 26.796 28.24 28.196C28.24 29.5027 27.9787 30.6693 27.456 31.696C26.952 32.7227 26.196 33.5347 25.188 34.132C24.18 34.7107 22.9667 35 21.548 35C19.6253 35 18.1133 34.58 17.012 33.74C15.9293 32.8813 15.164 31.6773 14.716 30.128C14.2867 28.5787 14.072 26.6467 14.072 24.332C14.072 17.5 16.48 14.084 21.296 14.084C23.1627 14.084 24.628 14.588 25.692 15.596C26.7747 16.604 27.4093 17.8453 27.596 19.32H24.656ZM21.268 24.164C20.1293 24.164 19.1587 24.5093 18.356 25.2C17.572 25.872 17.18 26.852 17.18 28.14C17.18 29.428 17.544 30.4547 18.272 31.22C19.0187 31.9667 20.0547 32.34 21.38 32.34C22.556 32.34 23.48 31.976 24.152 31.248C24.8427 30.52 25.188 29.5493 25.188 28.336C25.188 27.0667 24.852 26.0587 24.18 25.312C23.5267 24.5467 22.556 24.164 21.268 24.164Z"
                            fill="#3E1CC5" />
                        <path
                            d="M71.848 15.147V17.71H74.642V18.535H71.848V21.175H74.972V22H70.847V14.322H74.972V15.147H71.848ZM78.6481 22.099C78.1861 22.099 77.7718 22.022 77.4051 21.868C77.0385 21.7067 76.7488 21.4867 76.5361 21.208C76.3235 20.922 76.2061 20.5957 76.1841 20.229H77.2181C77.2475 20.5297 77.3868 20.7753 77.6361 20.966C77.8928 21.1567 78.2265 21.252 78.6371 21.252C79.0185 21.252 79.3191 21.1677 79.5391 20.999C79.7591 20.8303 79.8691 20.6177 79.8691 20.361C79.8691 20.097 79.7518 19.9027 79.5171 19.778C79.2825 19.646 78.9195 19.5177 78.4281 19.393C77.9808 19.2757 77.6141 19.1583 77.3281 19.041C77.0495 18.9163 76.8075 18.7367 76.6021 18.502C76.4041 18.26 76.3051 17.9447 76.3051 17.556C76.3051 17.248 76.3968 16.9657 76.5801 16.709C76.7635 16.4523 77.0238 16.2507 77.3611 16.104C77.6985 15.95 78.0835 15.873 78.5161 15.873C79.1835 15.873 79.7225 16.0417 80.1331 16.379C80.5438 16.7163 80.7638 17.1783 80.7931 17.765H79.7921C79.7701 17.4497 79.6418 17.1967 79.4071 17.006C79.1798 16.8153 78.8718 16.72 78.4831 16.72C78.1238 16.72 77.8378 16.797 77.6251 16.951C77.4125 17.105 77.3061 17.3067 77.3061 17.556C77.3061 17.754 77.3685 17.919 77.4931 18.051C77.6251 18.1757 77.7865 18.2783 77.9771 18.359C78.1751 18.4323 78.4465 18.5167 78.7911 18.612C79.2238 18.7293 79.5758 18.8467 79.8471 18.964C80.1185 19.074 80.3495 19.2427 80.5401 19.47C80.7381 19.6973 80.8408 19.9943 80.8481 20.361C80.8481 20.691 80.7565 20.988 80.5731 21.252C80.3898 21.516 80.1295 21.725 79.7921 21.879C79.4621 22.0257 79.0808 22.099 78.6481 22.099ZM83.5097 16.797V20.35C83.5097 20.6433 83.5721 20.8523 83.6967 20.977C83.8214 21.0943 84.0377 21.153 84.3457 21.153H85.0827V22H84.1807C83.6234 22 83.2054 21.8717 82.9267 21.615C82.6481 21.3583 82.5087 20.9367 82.5087 20.35V16.797H81.7277V15.972H82.5087V14.454H83.5097V15.972H85.0827V16.797H83.5097ZM85.9491 18.964C85.9491 18.348 86.0737 17.809 86.3231 17.347C86.5724 16.8777 86.9134 16.5147 87.3461 16.258C87.7861 16.0013 88.2737 15.873 88.8091 15.873C89.3371 15.873 89.7954 15.9867 90.1841 16.214C90.5727 16.4413 90.8624 16.7273 91.0531 17.072V15.972H92.0651V22H91.0531V20.878C90.8551 21.23 90.5581 21.5233 90.1621 21.758C89.7734 21.9853 89.3187 22.099 88.7981 22.099C88.2627 22.099 87.7787 21.967 87.3461 21.703C86.9134 21.439 86.5724 21.0687 86.3231 20.592C86.0737 20.1153 85.9491 19.5727 85.9491 18.964ZM91.0531 18.975C91.0531 18.5203 90.9614 18.1243 90.7781 17.787C90.5947 17.4497 90.3454 17.193 90.0301 17.017C89.7221 16.8337 89.3811 16.742 89.0071 16.742C88.6331 16.742 88.2921 16.83 87.9841 17.006C87.6761 17.182 87.4304 17.4387 87.2471 17.776C87.0637 18.1133 86.9721 18.5093 86.9721 18.964C86.9721 19.426 87.0637 19.8293 87.2471 20.174C87.4304 20.5113 87.6761 20.7717 87.9841 20.955C88.2921 21.131 88.6331 21.219 89.0071 21.219C89.3811 21.219 89.7221 21.131 90.0301 20.955C90.3454 20.7717 90.5947 20.5113 90.7781 20.174C90.9614 19.8293 91.0531 19.4297 91.0531 18.975ZM94.7851 17.094C94.9905 16.7347 95.2911 16.4413 95.6871 16.214C96.0831 15.9867 96.5341 15.873 97.0401 15.873C97.5828 15.873 98.0705 16.0013 98.5031 16.258C98.9358 16.5147 99.2768 16.8777 99.5261 17.347C99.7755 17.809 99.9001 18.348 99.9001 18.964C99.9001 19.5727 99.7755 20.1153 99.5261 20.592C99.2768 21.0687 98.9321 21.439 98.4921 21.703C98.0595 21.967 97.5755 22.099 97.0401 22.099C96.5195 22.099 96.0611 21.9853 95.6651 21.758C95.2765 21.5307 94.9831 21.241 94.7851 20.889V22H93.7841V13.86H94.7851V17.094ZM98.8771 18.964C98.8771 18.5093 98.7855 18.1133 98.6021 17.776C98.4188 17.4387 98.1695 17.182 97.8541 17.006C97.5461 16.83 97.2051 16.742 96.8311 16.742C96.4645 16.742 96.1235 16.8337 95.8081 17.017C95.5001 17.193 95.2508 17.4533 95.0601 17.798C94.8768 18.1353 94.7851 18.5277 94.7851 18.975C94.7851 19.4297 94.8768 19.8293 95.0601 20.174C95.2508 20.5113 95.5001 20.7717 95.8081 20.955C96.1235 21.131 96.4645 21.219 96.8311 21.219C97.2051 21.219 97.5461 21.131 97.8541 20.955C98.1695 20.7717 98.4188 20.5113 98.6021 20.174C98.7855 19.8293 98.8771 19.426 98.8771 18.964ZM102.246 13.86V22H101.245V13.86H102.246ZM109.48 18.755C109.48 18.9457 109.469 19.1473 109.447 19.36H104.629C104.665 19.954 104.867 20.4197 105.234 20.757C105.608 21.087 106.059 21.252 106.587 21.252C107.019 21.252 107.379 21.153 107.665 20.955C107.958 20.7497 108.163 20.4783 108.281 20.141H109.359C109.197 20.7203 108.875 21.1933 108.391 21.56C107.907 21.9193 107.305 22.099 106.587 22.099C106.015 22.099 105.501 21.9707 105.047 21.714C104.599 21.4573 104.247 21.0943 103.991 20.625C103.734 20.1483 103.606 19.5983 103.606 18.975C103.606 18.3517 103.73 17.8053 103.98 17.336C104.229 16.8667 104.577 16.5073 105.025 16.258C105.479 16.0013 106 15.873 106.587 15.873C107.159 15.873 107.665 15.9977 108.105 16.247C108.545 16.4963 108.882 16.841 109.117 17.281C109.359 17.7137 109.48 18.205 109.48 18.755ZM108.446 18.546C108.446 18.1647 108.361 17.8383 108.193 17.567C108.024 17.2883 107.793 17.0793 107.5 16.94C107.214 16.7933 106.895 16.72 106.543 16.72C106.037 16.72 105.604 16.8813 105.245 17.204C104.893 17.5267 104.691 17.974 104.64 18.546H108.446ZM110.455 18.975C110.455 18.3517 110.579 17.809 110.829 17.347C111.078 16.8777 111.423 16.5147 111.863 16.258C112.31 16.0013 112.82 15.873 113.392 15.873C114.132 15.873 114.741 16.0527 115.218 16.412C115.702 16.7713 116.021 17.27 116.175 17.908H115.097C114.994 17.5413 114.792 17.2517 114.492 17.039C114.198 16.8263 113.832 16.72 113.392 16.72C112.82 16.72 112.358 16.918 112.006 17.314C111.654 17.7027 111.478 18.2563 111.478 18.975C111.478 19.701 111.654 20.262 112.006 20.658C112.358 21.054 112.82 21.252 113.392 21.252C113.832 21.252 114.198 21.1493 114.492 20.944C114.785 20.7387 114.987 20.4453 115.097 20.064H116.175C116.013 20.68 115.691 21.175 115.207 21.549C114.723 21.9157 114.118 22.099 113.392 22.099C112.82 22.099 112.31 21.9707 111.863 21.714C111.423 21.4573 111.078 21.0943 110.829 20.625C110.579 20.1557 110.455 19.6057 110.455 18.975ZM118.055 14.993C117.864 14.993 117.703 14.927 117.571 14.795C117.439 14.663 117.373 14.5017 117.373 14.311C117.373 14.1203 117.439 13.959 117.571 13.827C117.703 13.695 117.864 13.629 118.055 13.629C118.238 13.629 118.392 13.695 118.517 13.827C118.649 13.959 118.715 14.1203 118.715 14.311C118.715 14.5017 118.649 14.663 118.517 14.795C118.392 14.927 118.238 14.993 118.055 14.993ZM118.539 15.972V22H117.538V15.972H118.539ZM127.521 15.862C127.991 15.862 128.409 15.961 128.775 16.159C129.142 16.3497 129.432 16.6393 129.644 17.028C129.857 17.4167 129.963 17.8897 129.963 18.447V22H128.973V18.59C128.973 17.9887 128.823 17.5303 128.522 17.215C128.229 16.8923 127.829 16.731 127.323 16.731C126.803 16.731 126.388 16.8997 126.08 17.237C125.772 17.567 125.618 18.0473 125.618 18.678V22H124.628V18.59C124.628 17.9887 124.478 17.5303 124.177 17.215C123.884 16.8923 123.484 16.731 122.978 16.731C122.458 16.731 122.043 16.8997 121.735 17.237C121.427 17.567 121.273 18.0473 121.273 18.678V22H120.272V15.972H121.273V16.841C121.471 16.5257 121.735 16.2837 122.065 16.115C122.403 15.9463 122.773 15.862 123.176 15.862C123.682 15.862 124.13 15.9757 124.518 16.203C124.907 16.4303 125.197 16.764 125.387 17.204C125.556 16.7787 125.835 16.4487 126.223 16.214C126.612 15.9793 127.045 15.862 127.521 15.862ZM132.15 14.993C131.959 14.993 131.798 14.927 131.666 14.795C131.534 14.663 131.468 14.5017 131.468 14.311C131.468 14.1203 131.534 13.959 131.666 13.827C131.798 13.695 131.959 13.629 132.15 13.629C132.333 13.629 132.487 13.695 132.612 13.827C132.744 13.959 132.81 14.1203 132.81 14.311C132.81 14.5017 132.744 14.663 132.612 14.795C132.487 14.927 132.333 14.993 132.15 14.993ZM132.634 15.972V22H131.633V15.972H132.634ZM139.867 18.755C139.867 18.9457 139.856 19.1473 139.834 19.36H135.016C135.053 19.954 135.255 20.4197 135.621 20.757C135.995 21.087 136.446 21.252 136.974 21.252C137.407 21.252 137.766 21.153 138.052 20.955C138.346 20.7497 138.551 20.4783 138.668 20.141H139.746C139.585 20.7203 139.262 21.1933 138.778 21.56C138.294 21.9193 137.693 22.099 136.974 22.099C136.402 22.099 135.889 21.9707 135.434 21.714C134.987 21.4573 134.635 21.0943 134.378 20.625C134.122 20.1483 133.993 19.5983 133.993 18.975C133.993 18.3517 134.118 17.8053 134.367 17.336C134.617 16.8667 134.965 16.5073 135.412 16.258C135.867 16.0013 136.388 15.873 136.974 15.873C137.546 15.873 138.052 15.9977 138.492 16.247C138.932 16.4963 139.27 16.841 139.504 17.281C139.746 17.7137 139.867 18.205 139.867 18.755ZM138.833 18.546C138.833 18.1647 138.749 17.8383 138.58 17.567C138.412 17.2883 138.181 17.0793 137.887 16.94C137.601 16.7933 137.282 16.72 136.93 16.72C136.424 16.72 135.992 16.8813 135.632 17.204C135.28 17.5267 135.079 17.974 135.027 18.546H138.833ZM144.153 15.862C144.886 15.862 145.48 16.0857 145.935 16.533C146.39 16.973 146.617 17.611 146.617 18.447V22H145.627V18.59C145.627 17.9887 145.477 17.5303 145.176 17.215C144.875 16.8923 144.465 16.731 143.944 16.731C143.416 16.731 142.994 16.896 142.679 17.226C142.371 17.556 142.217 18.0363 142.217 18.667V22H141.216V15.972H142.217V16.83C142.415 16.522 142.683 16.2837 143.02 16.115C143.365 15.9463 143.742 15.862 144.153 15.862ZM149.501 16.797V20.35C149.501 20.6433 149.563 20.8523 149.688 20.977C149.812 21.0943 150.029 21.153 150.337 21.153H151.074V22H150.172C149.614 22 149.196 21.8717 148.918 21.615C148.639 21.3583 148.5 20.9367 148.5 20.35V16.797H147.719V15.972H148.5V14.454H149.501V15.972H151.074V16.797H149.501ZM154.943 22.099C154.378 22.099 153.865 21.9707 153.403 21.714C152.948 21.4573 152.589 21.0943 152.325 20.625C152.068 20.1483 151.94 19.5983 151.94 18.975C151.94 18.359 152.072 17.8163 152.336 17.347C152.607 16.8703 152.974 16.5073 153.436 16.258C153.898 16.0013 154.415 15.873 154.987 15.873C155.559 15.873 156.076 16.0013 156.538 16.258C157 16.5073 157.363 16.8667 157.627 17.336C157.898 17.8053 158.034 18.3517 158.034 18.975C158.034 19.5983 157.895 20.1483 157.616 20.625C157.345 21.0943 156.974 21.4573 156.505 21.714C156.036 21.9707 155.515 22.099 154.943 22.099ZM154.943 21.219C155.302 21.219 155.64 21.1347 155.955 20.966C156.27 20.7973 156.523 20.5443 156.714 20.207C156.912 19.8697 157.011 19.459 157.011 18.975C157.011 18.491 156.916 18.0803 156.725 17.743C156.534 17.4057 156.285 17.1563 155.977 16.995C155.669 16.8263 155.335 16.742 154.976 16.742C154.609 16.742 154.272 16.8263 153.964 16.995C153.663 17.1563 153.421 17.4057 153.238 17.743C153.055 18.0803 152.963 18.491 152.963 18.975C152.963 19.4663 153.051 19.8807 153.227 20.218C153.41 20.5553 153.652 20.8083 153.953 20.977C154.254 21.1383 154.584 21.219 154.943 21.219ZM161.512 22.099C161.05 22.099 160.635 22.022 160.269 21.868C159.902 21.7067 159.612 21.4867 159.4 21.208C159.187 20.922 159.07 20.5957 159.048 20.229H160.082C160.111 20.5297 160.25 20.7753 160.5 20.966C160.756 21.1567 161.09 21.252 161.501 21.252C161.882 21.252 162.183 21.1677 162.403 20.999C162.623 20.8303 162.733 20.6177 162.733 20.361C162.733 20.097 162.615 19.9027 162.381 19.778C162.146 19.646 161.783 19.5177 161.292 19.393C160.844 19.2757 160.478 19.1583 160.192 19.041C159.913 18.9163 159.671 18.7367 159.466 18.502C159.268 18.26 159.169 17.9447 159.169 17.556C159.169 17.248 159.26 16.9657 159.444 16.709C159.627 16.4523 159.887 16.2507 160.225 16.104C160.562 15.95 160.947 15.873 161.38 15.873C162.047 15.873 162.586 16.0417 162.997 16.379C163.407 16.7163 163.627 17.1783 163.657 17.765H162.656C162.634 17.4497 162.505 17.1967 162.271 17.006C162.043 16.8153 161.735 16.72 161.347 16.72C160.987 16.72 160.701 16.797 160.489 16.951C160.276 17.105 160.17 17.3067 160.17 17.556C160.17 17.754 160.232 17.919 160.357 18.051C160.489 18.1757 160.65 18.2783 160.841 18.359C161.039 18.4323 161.31 18.5167 161.655 18.612C162.087 18.7293 162.439 18.8467 162.711 18.964C162.982 19.074 163.213 19.2427 163.404 19.47C163.602 19.6973 163.704 19.9943 163.712 20.361C163.712 20.691 163.62 20.988 163.437 21.252C163.253 21.516 162.993 21.725 162.656 21.879C162.326 22.0257 161.944 22.099 161.512 22.099ZM70.473 32.975C70.473 32.3517 70.5977 31.809 70.847 31.347C71.0963 30.8777 71.441 30.5147 71.881 30.258C72.3283 30.0013 72.838 29.873 73.41 29.873C74.1507 29.873 74.7593 30.0527 75.236 30.412C75.72 30.7713 76.039 31.27 76.193 31.908H75.115C75.0123 31.5413 74.8107 31.2517 74.51 31.039C74.2167 30.8263 73.85 30.72 73.41 30.72C72.838 30.72 72.376 30.918 72.024 31.314C71.672 31.7027 71.496 32.2563 71.496 32.975C71.496 33.701 71.672 34.262 72.024 34.658C72.376 35.054 72.838 35.252 73.41 35.252C73.85 35.252 74.2167 35.1493 74.51 34.944C74.8033 34.7387 75.005 34.4453 75.115 34.064H76.193C76.0317 34.68 75.709 35.175 75.225 35.549C74.741 35.9157 74.136 36.099 73.41 36.099C72.838 36.099 72.3283 35.9707 71.881 35.714C71.441 35.4573 71.0963 35.0943 70.847 34.625C70.5977 34.1557 70.473 33.6057 70.473 32.975ZM80.1851 36.099C79.6205 36.099 79.1071 35.9707 78.6451 35.714C78.1905 35.4573 77.8311 35.0943 77.5671 34.625C77.3105 34.1483 77.1821 33.5983 77.1821 32.975C77.1821 32.359 77.3141 31.8163 77.5781 31.347C77.8495 30.8703 78.2161 30.5073 78.6781 30.258C79.1401 30.0013 79.6571 29.873 80.2291 29.873C80.8011 29.873 81.3181 30.0013 81.7801 30.258C82.2421 30.5073 82.6051 30.8667 82.8691 31.336C83.1405 31.8053 83.2761 32.3517 83.2761 32.975C83.2761 33.5983 83.1368 34.1483 82.8581 34.625C82.5868 35.0943 82.2165 35.4573 81.7471 35.714C81.2778 35.9707 80.7571 36.099 80.1851 36.099ZM80.1851 35.219C80.5445 35.219 80.8818 35.1347 81.1971 34.966C81.5125 34.7973 81.7655 34.5443 81.9561 34.207C82.1541 33.8697 82.2531 33.459 82.2531 32.975C82.2531 32.491 82.1578 32.0803 81.9671 31.743C81.7765 31.4057 81.5271 31.1563 81.2191 30.995C80.9111 30.8263 80.5775 30.742 80.2181 30.742C79.8515 30.742 79.5141 30.8263 79.2061 30.995C78.9055 31.1563 78.6635 31.4057 78.4801 31.743C78.2968 32.0803 78.2051 32.491 78.2051 32.975C78.2051 33.4663 78.2931 33.8807 78.4691 34.218C78.6525 34.5553 78.8945 34.8083 79.1951 34.977C79.4958 35.1383 79.8258 35.219 80.1851 35.219ZM87.5568 29.862C88.2901 29.862 88.8841 30.0857 89.3388 30.533C89.7934 30.973 90.0208 31.611 90.0208 32.447V36H89.0308V32.59C89.0308 31.9887 88.8804 31.5303 88.5798 31.215C88.2791 30.8923 87.8684 30.731 87.3478 30.731C86.8198 30.731 86.3981 30.896 86.0828 31.226C85.7748 31.556 85.6208 32.0363 85.6208 32.667V36H84.6198V29.972H85.6208V30.83C85.8188 30.522 86.0864 30.2837 86.4238 30.115C86.7684 29.9463 87.1461 29.862 87.5568 29.862ZM96.8875 35.076L98.7575 29.972H99.8245L97.4595 36H96.2935L93.9285 29.972H95.0065L96.8875 35.076ZM100.463 32.964C100.463 32.348 100.588 31.809 100.837 31.347C101.086 30.8777 101.427 30.5147 101.86 30.258C102.3 30.0013 102.788 29.873 103.323 29.873C103.851 29.873 104.309 29.9867 104.698 30.214C105.087 30.4413 105.376 30.7273 105.567 31.072V29.972H106.579V36H105.567V34.878C105.369 35.23 105.072 35.5233 104.676 35.758C104.287 35.9853 103.833 36.099 103.312 36.099C102.777 36.099 102.293 35.967 101.86 35.703C101.427 35.439 101.086 35.0687 100.837 34.592C100.588 34.1153 100.463 33.5727 100.463 32.964ZM105.567 32.975C105.567 32.5203 105.475 32.1243 105.292 31.787C105.109 31.4497 104.859 31.193 104.544 31.017C104.236 30.8337 103.895 30.742 103.521 30.742C103.147 30.742 102.806 30.83 102.498 31.006C102.19 31.182 101.944 31.4387 101.761 31.776C101.578 32.1133 101.486 32.5093 101.486 32.964C101.486 33.426 101.578 33.8293 101.761 34.174C101.944 34.5113 102.19 34.7717 102.498 34.955C102.806 35.131 103.147 35.219 103.521 35.219C103.895 35.219 104.236 35.131 104.544 34.955C104.859 34.7717 105.109 34.5113 105.292 34.174C105.475 33.8293 105.567 33.4297 105.567 32.975ZM107.924 32.975C107.924 32.3517 108.049 31.809 108.298 31.347C108.547 30.8777 108.892 30.5147 109.332 30.258C109.779 30.0013 110.289 29.873 110.861 29.873C111.602 29.873 112.21 30.0527 112.687 30.412C113.171 30.7713 113.49 31.27 113.644 31.908H112.566C112.463 31.5413 112.262 31.2517 111.961 31.039C111.668 30.8263 111.301 30.72 110.861 30.72C110.289 30.72 109.827 30.918 109.475 31.314C109.123 31.7027 108.947 32.2563 108.947 32.975C108.947 33.701 109.123 34.262 109.475 34.658C109.827 35.054 110.289 35.252 110.861 35.252C111.301 35.252 111.668 35.1493 111.961 34.944C112.254 34.7387 112.456 34.4453 112.566 34.064H113.644C113.483 34.68 113.16 35.175 112.676 35.549C112.192 35.9157 111.587 36.099 110.861 36.099C110.289 36.099 109.779 35.9707 109.332 35.714C108.892 35.4573 108.547 35.0943 108.298 34.625C108.049 34.1557 107.924 33.6057 107.924 32.975ZM114.633 32.964C114.633 32.348 114.758 31.809 115.007 31.347C115.257 30.8777 115.598 30.5147 116.03 30.258C116.47 30.0013 116.958 29.873 117.493 29.873C118.021 29.873 118.48 29.9867 118.868 30.214C119.257 30.4413 119.547 30.7273 119.737 31.072V29.972H120.749V36H119.737V34.878C119.539 35.23 119.242 35.5233 118.846 35.758C118.458 35.9853 118.003 36.099 117.482 36.099C116.947 36.099 116.463 35.967 116.03 35.703C115.598 35.439 115.257 35.0687 115.007 34.592C114.758 34.1153 114.633 33.5727 114.633 32.964ZM119.737 32.975C119.737 32.5203 119.646 32.1243 119.462 31.787C119.279 31.4497 119.03 31.193 118.714 31.017C118.406 30.8337 118.065 30.742 117.691 30.742C117.317 30.742 116.976 30.83 116.668 31.006C116.36 31.182 116.115 31.4387 115.931 31.776C115.748 32.1133 115.656 32.5093 115.656 32.964C115.656 33.426 115.748 33.8293 115.931 34.174C116.115 34.5113 116.36 34.7717 116.668 34.955C116.976 35.131 117.317 35.219 117.691 35.219C118.065 35.219 118.406 35.131 118.714 34.955C119.03 34.7717 119.279 34.5113 119.462 34.174C119.646 33.8293 119.737 33.4297 119.737 32.975ZM125.405 29.862C126.139 29.862 126.733 30.0857 127.187 30.533C127.642 30.973 127.869 31.611 127.869 32.447V36H126.879V32.59C126.879 31.9887 126.729 31.5303 126.428 31.215C126.128 30.8923 125.717 30.731 125.196 30.731C124.668 30.731 124.247 30.896 123.931 31.226C123.623 31.556 123.469 32.0363 123.469 32.667V36H122.468V29.972H123.469V30.83C123.667 30.522 123.935 30.2837 124.272 30.115C124.617 29.9463 124.995 29.862 125.405 29.862ZM130.753 30.797V34.35C130.753 34.6433 130.815 34.8523 130.94 34.977C131.065 35.0943 131.281 35.153 131.589 35.153H132.326V36H131.424C130.867 36 130.449 35.8717 130.17 35.615C129.891 35.3583 129.752 34.9367 129.752 34.35V30.797H128.971V29.972H129.752V28.454H130.753V29.972H132.326V30.797H130.753ZM139.066 32.755C139.066 32.9457 139.055 33.1473 139.033 33.36H134.215C134.252 33.954 134.454 34.4197 134.82 34.757C135.194 35.087 135.645 35.252 136.173 35.252C136.606 35.252 136.965 35.153 137.251 34.955C137.545 34.7497 137.75 34.4783 137.867 34.141H138.945C138.784 34.7203 138.461 35.1933 137.977 35.56C137.493 35.9193 136.892 36.099 136.173 36.099C135.601 36.099 135.088 35.9707 134.633 35.714C134.186 35.4573 133.834 35.0943 133.577 34.625C133.321 34.1483 133.192 33.5983 133.192 32.975C133.192 32.3517 133.317 31.8053 133.566 31.336C133.816 30.8667 134.164 30.5073 134.611 30.258C135.066 30.0013 135.587 29.873 136.173 29.873C136.745 29.873 137.251 29.9977 137.691 30.247C138.131 30.4963 138.469 30.841 138.703 31.281C138.945 31.7137 139.066 32.205 139.066 32.755ZM138.032 32.546C138.032 32.1647 137.948 31.8383 137.779 31.567C137.611 31.2883 137.38 31.0793 137.086 30.94C136.8 30.7933 136.481 30.72 136.129 30.72C135.623 30.72 135.191 30.8813 134.831 31.204C134.479 31.5267 134.278 31.974 134.226 32.546H138.032ZM142.549 36.099C142.087 36.099 141.673 36.022 141.306 35.868C140.939 35.7067 140.65 35.4867 140.437 35.208C140.224 34.922 140.107 34.5957 140.085 34.229H141.119C141.148 34.5297 141.288 34.7753 141.537 34.966C141.794 35.1567 142.127 35.252 142.538 35.252C142.919 35.252 143.22 35.1677 143.44 34.999C143.66 34.8303 143.77 34.6177 143.77 34.361C143.77 34.097 143.653 33.9027 143.418 33.778C143.183 33.646 142.82 33.5177 142.329 33.393C141.882 33.2757 141.515 33.1583 141.229 33.041C140.95 32.9163 140.708 32.7367 140.503 32.502C140.305 32.26 140.206 31.9447 140.206 31.556C140.206 31.248 140.298 30.9657 140.481 30.709C140.664 30.4523 140.925 30.2507 141.262 30.104C141.599 29.95 141.984 29.873 142.417 29.873C143.084 29.873 143.623 30.0417 144.034 30.379C144.445 30.7163 144.665 31.1783 144.694 31.765H143.693C143.671 31.4497 143.543 31.1967 143.308 31.006C143.081 30.8153 142.773 30.72 142.384 30.72C142.025 30.72 141.739 30.797 141.526 30.951C141.313 31.105 141.207 31.3067 141.207 31.556C141.207 31.754 141.269 31.919 141.394 32.051C141.526 32.1757 141.687 32.2783 141.878 32.359C142.076 32.4323 142.347 32.5167 142.692 32.612C143.125 32.7293 143.477 32.8467 143.748 32.964C144.019 33.074 144.25 33.2427 144.441 33.47C144.639 33.6973 144.742 33.9943 144.749 34.361C144.749 34.691 144.657 34.988 144.474 35.252C144.291 35.516 144.03 35.725 143.693 35.879C143.363 36.0257 142.982 36.099 142.549 36.099Z"
                            fill="#3E1CC5" />
                        <g clip-path="url(#clip0_2371_2895)">
                            <path
                                d="M45 32.6C40.8035 32.6 37.4 29.1965 37.4 25C37.4 20.8035 40.8035 17.4 45 17.4C49.1965 17.4 52.6 20.8035 52.6 25C52.6 29.1965 49.1965 32.6 45 32.6ZM45 23.5565C44.1878 23.5565 43.5565 24.1878 43.5565 25C43.5565 25.8122 44.1878 26.4435 45 26.4435C45.8122 26.4435 46.4435 25.8122 46.4435 25C46.4435 24.1878 45.8122 23.5565 45 23.5565Z"
                                fill="white" fill-opacity="0.4" stroke="white" stroke-width="0.8" />
                            <mask id="path-5-inside-1_2371_2895" fill="white">
                                <path fill-rule="evenodd" clip-rule="evenodd"
                                    d="M40.8242 25.0001C40.8242 27.3048 42.6934 29.174 44.9981 29.174C47.3029 29.174 49.172 27.3048 49.172 25.0001C49.172 22.6954 47.3029 20.8262 44.9981 20.8262C42.6934 20.8262 40.8242 22.6954 40.8242 25.0001ZM44.9981 26.0436C45.5744 26.0436 46.0416 25.5764 46.0416 25.0001C46.0416 24.4238 45.5744 23.9566 44.9981 23.9566C44.4218 23.9566 43.9547 24.4238 43.9547 25.0001C43.9547 25.5764 44.4218 26.0436 44.9981 26.0436Z" />
                            </mask>
                            <path fill-rule="evenodd" clip-rule="evenodd"
                                d="M40.8242 25.0001C40.8242 27.3048 42.6934 29.174 44.9981 29.174C47.3029 29.174 49.172 27.3048 49.172 25.0001C49.172 22.6954 47.3029 20.8262 44.9981 20.8262C42.6934 20.8262 40.8242 22.6954 40.8242 25.0001ZM44.9981 26.0436C45.5744 26.0436 46.0416 25.5764 46.0416 25.0001C46.0416 24.4238 45.5744 23.9566 44.9981 23.9566C44.4218 23.9566 43.9547 24.4238 43.9547 25.0001C43.9547 25.5764 44.4218 26.0436 44.9981 26.0436Z"
                                fill="#5627FF" fill-opacity="0.6" />
                            <path
                                d="M44.9981 28.574C43.0248 28.574 41.4242 26.9734 41.4242 25.0001H40.2242C40.2242 27.6362 42.362 29.774 44.9981 29.774V28.574ZM48.572 25.0001C48.572 26.9734 46.9715 28.574 44.9981 28.574V29.774C47.6342 29.774 49.772 27.6362 49.772 25.0001H48.572ZM44.9981 21.4262C46.9715 21.4262 48.572 23.0267 48.572 25.0001H49.772C49.772 22.364 47.6342 20.2262 44.9981 20.2262V21.4262ZM41.4242 25.0001C41.4242 23.0267 43.0248 21.4262 44.9981 21.4262V20.2262C42.362 20.2262 40.2242 22.364 40.2242 25.0001H41.4242ZM45.4416 25.0001C45.4416 25.245 45.2431 25.4436 44.9981 25.4436V26.6436C45.9058 26.6436 46.6416 25.9078 46.6416 25.0001H45.4416ZM44.9981 24.5566C45.2431 24.5566 45.4416 24.7552 45.4416 25.0001H46.6416C46.6416 24.0924 45.9058 23.3566 44.9981 23.3566V24.5566ZM44.5547 25.0001C44.5547 24.7552 44.7532 24.5566 44.9981 24.5566V23.3566C44.0905 23.3566 43.3547 24.0924 43.3547 25.0001H44.5547ZM44.9981 25.4436C44.7532 25.4436 44.5547 25.245 44.5547 25.0001H43.3547C43.3547 25.9078 44.0905 26.6436 44.9981 26.6436V25.4436Z"
                                fill="#5627FF" mask="url(#path-5-inside-1_2371_2895)" />
                        </g>
                        <defs>
                            <clipPath id="clip0_2371_2895">
                                <rect width="16" height="16" fill="white" transform="translate(37 17)" />
                            </clipPath>
                        </defs>
                    </svg>
                </div>


            </section>
        </div>
        <!-- Explorer map -->
        <section class="map-iframe">
            <GoogleMap v-if="treatment === 1" class="g-map-container-1" :api-key="GMAP_API_KEY"
                :center="researchStore.centerLocation" :zoom="13.5" :styles="mapStyle" :disableDefaultUI="true"
                :clickableIcons="false" :mapTypeControl="false" :fullscreenControl="false" :streetViewControl="false"
                :gestureHandling="'greedy'" :zoomControl="false">
                <Circle :options="{ center: researchStore.centerLocation, ...styleCircle }" />
                <CustomMarker :options="{ position: researchStore.centerLocation }">
                    <img src="../assets/marker-user.svg" />
                </CustomMarker>
            </GoogleMap>
            <iframe v-else :src="getSrcIframeExplorer()"></iframe>
        </section>
        <div class="next-step">
            <button @click="nextStep()">
                Ir a Explorar
            </button>
            <span class="nex-step__disclaimer">
                Puedes Informarte más sobre los establecimientos en
                <a href="https://www.sistemadeadmisionescolar.cl/" target="_blank">www.sistemadeadmisionescolar.cl</a>
            </span>
        </div>

    </div>
</template>
<style scoped>
.total-vacancies {
    display: flex;
    width: 1.25rem;
    height: 2.5rem;
    flex-direction: column;
    justify-content: center;
    flex-shrink: 0;
    color: var(--alias-secondary-1-default-strong, #3E1CC5);
    font-family: Poppins;
    font-size: 1.75rem;
    font-style: normal;
    font-weight: 500;
    line-height: 1.5rem;
}

.map-iframe {
    /* margin-left: -0rem; */
    /* background-color: red; */
    width: 100%;
    min-height: 500px;
    position: absolute;
    margin-top: 10rem;
    /* margin-left: -2rem; */
    right: 0;
}

.next-step {
    position: absolute;
    bottom: 0;
    right: 0;
    margin: 1rem;
    padding-left: 2rem;
    width: 100%;
    display: flex;
    flex-direction: column;
    align-items: flex-end;
}

.nex-step__disclaimer,
a {
    color: white !important;
    font-family: Inter;
    font-size: 11px;
    line-height: 16px;
    font-size: 0.8rem !important;
    text-align: center !important;
    margin-top: 0.5rem;
}

.next-step>button {
    border-radius: 30px;
    background-color: white;
    box-shadow: -4px 4px 10px 0px rgba(128, 128, 128, 0.10);
    max-width: 360px;
    width: 100%;
    height: 48px;
    flex-shrink: 0;
    font-family: Poppins;
    font-size: 16px;
    font-style: normal;
    font-weight: 500;
    line-height: 40px;
    letter-spacing: 0.32px;
    color: #1E0C61 !important;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    min-width: 290px;
}

.go-to-explorer {
    margin-top: 1.5rem;
    width: 100%;
    /* height: 100%; */
    display: flex;
    flex-direction: column;
    color: #5627FF;
}

.second-information {
    margin-left: -1rem;
}

.go-to-explorer__information {
    width: 100%;
    display: flex;
    flex-direction: row;
    align-items: flex-end;
    position: relative;
    margin-bottom: -0.5rem;
}


.go-to-explorer__information>div {
    width: 152px;
    height: 102px;
    display: flex;
    flex-direction: column;
    position: relative;
    z-index: 1;
    /* position: absolute; */
}

p,
span {
    z-index: 5;
}

p {
    font-weight: 500;
    font-size: 36px;
    line-height: 24px;
    color: #F5F5F5;
}

.information {
    font-weight: 400;
    font-size: 12px;
    line-height: 16px;
    letter-spacing: 0.0025em;
    color: #FFFFFF;
}

.go-to-explorer__information>div>img {
    position: absolute;
    z-index: 0;
}

.go-to-explorer>section:first-child {
    margin-top: 1rem;
    width: 100%;
    height: auto;
}

iframe {
    /* margin-left: -2rem; */
    /* position: absolute !important; */
    display: block;
    border: none;
    max-height: 750px;
    height: 100vh !important;
    width: 100% !important;
}

.g-map-container-1 {
    max-height: 750px;
    height: 100vh !important;
    width: 100vw !important;
}</style>
